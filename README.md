# Трекер полезных привычек
##  бэкенд-часть SPA веб-приложения

### пример привычки описывается как конкретное действие, которое можно уложить в одно предложение:

я буду [ДЕЙСТВИЕ] в [ВРЕМЯ] в [МЕСТО]

За каждую полезную привычку необходимо себя вознаграждать или сразу после делать приятную привычку. Но при этом привычка не должна расходовать на выполнение больше двух минут. 

## Модель

- Пользователь — создатель привычки.
- Место — место, в котором необходимо выполнять привычку.
- Время — время, когда необходимо выполнять привычку.
- Действие — действие, которое представляет собой привычка.
- Признак приятной привычки — привычка, которую можно привязать к выполнению полезной привычки.
- Связанная привычка — привычка, которая связана с другой привычкой, важно указывать для полезных привычек, но не для приятных.
- Периодичность (по умолчанию ежедневная) — периодичность выполнения привычки для напоминания в днях.
- Вознаграждение — чем пользователь должен себя вознаградить после выполнения.
- Время на выполнение — время, которое предположительно потратит пользователь на выполнение привычки.
- Признак публичности — привычки можно публиковать в общий доступ, чтобы другие пользователи могли брать в пример чужие привычки.

### Пример
- Действие - Выходить на прогулку
- Время - сразу после ужина
- Место - вокруг квартала

### Полезная привычка
это само действие, которое пользователь будет совершать и получать за его выполнение определенное вознаграждение (приятная привычка или любое другое вознаграждение).

### Приятная привычка
это способ вознаградить себя за выполнение полезной привычки. Приятная привычка указывается в качестве связанной для полезной привычки (в поле «Связанная привычка»).

Например: в качестве полезной привычки вы будете выходить на прогулку вокруг квартала сразу же после ужина. Вашим вознаграждением за это будет приятная привычка — 
принять ванну с пеной. То есть такая полезная привычка будет иметь связанную привычку.


## Валидаторы

- Исключен одновременный выбор связанной привычки и указания вознаграждения. Можно заполнить только одно из двух полей.
- Время выполнения должно быть не больше 120 секунд. 
- В связанные привычки могут попадать только привычки с признаком приятной привычки.
- У приятной привычки не может быть вознаграждения или связанной привычки.
- Нельзя выполнять привычку реже, чем 1 раз в 7 дней. 

## Пагинация

Для вывода списка привычек реализована пагинацию с выводом по 5 привычек на страницу.

## Права доступа

- Каждый пользователь имеет доступ только к своим привычкам по механизму CRUD.
- Пользователь может видеть список публичных привычек без возможности их как-то редактировать или удалять.

## Эндпоинты

- Регистрация.
- Авторизация.
- Список привычек текущего пользователя с пагинацией.
- Список публичных привычек.
- Создание привычки.
- Редактирование привычки.
- Удаление привычки.

## Интеграция

Для работы сервиса реализована работы с отложенными задачами Celery для напоминания о том, какие привычки необходимо выполнять.

Для этого сервис интегрирован с мессенджером Телеграм.

## Безопасность

Для проекта настроены CORS

## Документация 
http://0.0.0.0:8000/swagger/

Настроен вывод документации.

# Запуск через docker-compose
1. Заполнить файл `.env` с переменными окружения
2. Выполнить 
```commandline
    docker compose up --build
```
3. Сервис будет доступен по адресу: http://0.0.0.0:8000/

# Установка и использование (локально)

Для работы программы необходимо:

1. установить зависимости, указанные в файле  pyproject.toml:
- для первичной установки:

  ```poetry install```
- для обновления:

  ```poetry update```


2. создать файл `.env` с параметрами доступа к базе данных PostgresSQL и запуска сервера django.
3. выполнить миграции командой
```commandline
python3 ./manage.py migrate
```

4. запустить сервер:
```commandline
python3 ./manage.py runserver
```
## Проверка степени покрытия тестами (linux):
```commandline
        coverage run --source='.' manage.py test 
        coverage report  
```